<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>

    <record id="view_partner_form" model="ir.ui.view">
        <field name="name">res.partner.form</field>
        <field name="model">res.partner</field>
        <field name="inherit_id" ref="base.view_partner_form"/>
        <field name="arch" type="xml">
            <field name="website" position="after">
                <field name="product_ids" widget="many2many_tags"/>
            </field>
        </field>
    </record>

<!--
    <record id="view_product_form" model="ir.ui.view">
        <field name="name">product.product.form</field>
        <field name="model">product.product</field>
        <field name="inherit_id" ref="product.product_template_form_view"/>
        <field name="arch" type="xml">
            <page string="Information" position="inside">
                <field name="partner_id" widget="many2many_tags"/>
            </page>
        </field>
    </record>
-->

    <template id="mobile_order_view" name="Mobile Order View">
        <t t-call="website.layout">
            <div id="wrap">
                <div class="oe_structure">
                    <div class="container mt16 mb64" style="width: 100%; padding: 0px;">
                        <div class="col-md-12 col-sm-12">
                            <ul class="nav nav-tabs">
                                <li class="active">
                                    <a data-toggle="tab" href="#butiks_order">Butiksorder</a>
                                </li>
                                <li>
                                    <a data-toggle="tab" href="#kedjans_sortiment">Sortiment</a>
                                </li>
                                <li>
                                    <a data-toggle="tab" href="#kund_kort">Kundkort</a>
                                </li>
                            </ul>
                            <div class="tab-content">
                                <!-- Butiksorder -->
                                <div class="tab-pane fade in active col-xs-12 col-md-12 col-lg-12" id="butiks_order" style="padding: 0px;">
                                    <div class="container mb64">
                                        <h2 class="text-center mb32" t-esc="partner.name"/>

                                        <ul class="nav nav-tabs">
                                            <li class="active">
                                                <a data-toggle="tab" style="border-width: 0px;" href="#paolos_categ"><img src="/logo.png" style="width: 100px;"/></a>
                                            </li>
                                            <li>
                                                <a data-toggle="tab" style="border-width: 0px;" href="#unknown_categ"><img src="/logo.png" style="width: 100px;"/></a>
                                            </li>
                                        </ul>
                                        <div class="tab-content">
                                            <!-- Paolos -->
                                            <div class="tab-pane fade in active col-xs-12 col-md-12 col-lg-12" id="paolos_categ" style="padding: 0px;">
                                                <t t-set="p_categs" t-value="request.env['product.category'].search([('parent_id', '=', 3)])"/>
                                                <ul class="nav nav-tabs">
                                                    <li class="active">
                                                        <a data-toggle="tab" style="padding: 5px;" t-att-href="'&#35;paolos_categ_%s' %p_categs[0].id"><span t-field="p_categs[0].name"/></a>
                                                    </li>
                                                    <t t-foreach="p_categs[1:]" t-as="p_c">
                                                    <li>
                                                        <a data-toggle="tab" style="padding: 5px;" t-att-href="'&#35;paolos_categ_%s' %p_c.id"><span t-field="p_c.name"/></a>
                                                    </li>
                                                    </t>
                                                </ul>
                                                <div class="tab-content">
                                                    <!-- Paolos category first table -->
                                                    <div class="tab-pane fade in table-responsive active col-xs-12 col-md-12 col-lg-12" t-att-id="'paolos_categ_%s' %p_categs[0].id" style="padding: 0px;">
                                                        <table class="table" style="background-color: #FFA62B;">
                                                            <thead>
                                                                <tr>
                                                                    <th class="text-center" style="background-color: #000; color: #fff;">Products</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                <t t-foreach="products" t-as="p">
                                                                <tr>
                                                                    <t t-if="p.categ_id in p_categs[0]">
                                                                        <td>
                                                                            <div class="col-md-12 mb8">
                                                                                <div class="col-md-12">
                                                                                    <h6 class="text-center">[<span t-field="p.default_code"/>]</h6>
                                                                                </div>
                                                                                <div class="col-md-12">
                                                                                    <h4 class="text-center" t-att-onclick="'toggle_cell(&quot;%s&quot;)' %p.id" t-field="p.name"/>
                                                                                </div>
                                                                                <div class="col-md-12 input-group oe_website_spinner" style="margin: auto;">
                                                                                    <span class="input-group-addon mb8" t-att-onclick="'minus(&quot;product_%s_value&quot;)' %p.id">
                                                                                        <i class="fa fa-minus"></i>
                                                                                    </span>
                                                                                    <input class="form-control" data-min="1" t-att-id="'product_%s_value' %p.id" name="add_qty" value="0" type="text"/>
                                                                                    <span class="input-group-addon mb8 float_left" t-att-onclick="'plus(&quot;product_%s_value&quot;)' %p.id">
                                                                                        <i class="fa fa-plus"></i>
                                                                                    </span>
                                                                                </div>
                                                                            </div>
                                                                            <div class="talbe_cell" t-att-id="'product_cell_%s' %%p.id">
                                                                                <ul style="list-style-type: none;">
                                                                                    <li>Discount: <input name="discount"/></li>
                                                                                    <li>KFP: 250</li>
                                                                                    <li>DFP: 10</li>
                                                                                    <li>PALL: 70</li>
                                                                                    <li>NR: ?</li>
                                                                                </ul>
                                                                            </div>
                                                                        </td>
                                                                    </t>
                                                                </tr>
                                                                </t>
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                    <!-- Paolos category rest table -->
                                                    <t t-foreach="p_categs[1:]" t-as="p_c">
                                                        <div class="tab-pane fade in table-responsive col-xs-12 col-md-12 col-lg-12" t-att-id="'paolos_categ_%s' %p_c.id" style="padding: 0px;">
                                                            <table class="table" style="background-color: #FFA62B;">
                                                                <thead>
                                                                    <tr>
                                                                        <th class="text-center" style="background-color: #000; color: #fff;">Products</th>
                                                                    </tr>
                                                                </thead>
                                                                <tbody>
                                                                    <t t-foreach="products" t-as="p">
                                                                    <tr>
                                                                        <t t-if="p.categ_id in p_c">
                                                                            <td>
                                                                                <div class="col-md-12 mb8">
                                                                                    <div class="col-md-12">
                                                                                        <h6 class="text-center">[<span t-field="p.default_code"/>]</h6>
                                                                                    </div>
                                                                                    <div class="col-md-12">
                                                                                        <h4 class="text-center" t-att-onclick="'toggle_cell(&quot;%s&quot;)' %p.id" t-field="p.name"/>
                                                                                    </div>
                                                                                    <div class="col-md-12 input-group oe_website_spinner" style="margin: auto;">
                                                                                        <span class="input-group-addon mb8" t-att-onclick="'minus(&quot;product_%s_value&quot;)' %p.id">
                                                                                            <i class="fa fa-minus"></i>
                                                                                        </span>
                                                                                        <input class="form-control" data-min="1" t-att-id="'product_%s_value' %p.id" name="add_qty" value="0" type="text"/>
                                                                                        <span class="input-group-addon mb8 float_left" t-att-onclick="'plus(&quot;product_%s_value&quot;)' %p.id">
                                                                                            <i class="fa fa-plus"></i>
                                                                                        </span>
                                                                                    </div>
                                                                                </div>
                                                                                <div class="talbe_cell" t-att-id="'product_cell_%s' %%p.id">
                                                                                    <ul style="list-style-type: none;">
                                                                                        <li>Discount: <input name="discount"/></li>
                                                                                        <li>KFP: 250</li>
                                                                                        <li>DFP: 10</li>
                                                                                        <li>PALL: 70</li>
                                                                                        <li>NR: ?</li>
                                                                                    </ul>
                                                                                </div>
                                                                            </td>
                                                                        </t>
                                                                    </tr>
                                                                    </t>
                                                                </tbody>
                                                            </table>
                                                        </div>
                                                    </t>
                                                </div>
                                            </div>
                                            <!-- Unknown -->
                                            <div class="tab-pane fade in col-xs-12 col-md-12 col-lg-12" id="unknown_categ" style="padding: 0px; border-width: 0px;">

                                            </div>
                                        </div>

                                        <!--
                                        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 mt8 mb8" style="padding: 0px;" t-foreach="products" t-as="p">
                                            <div class="col-xs-6 col-sm-7 col-md-7 col-lg-7" style="padding-left: 0px;">
                                                <img itemprop="image" class="img img-responsive" style="margin: auto;" t-att-src="'/website/image/product.product/%s/image/150x150' %p.id"/>
                                            </div>
                                            <div class="col-xs-6 col-sm-5 col-md-5 col-lg-4 col-lg-offset-1">
                                                <p class="text-center">
                                                    <t t-if="p.default_code">
                                                        <span>[<t t-esc="p.default_code"/>] </span>
                                                    </t>
                                                    <span class="text-center" t-field="p.product_tmpl_id"/>
                                                </p>
                                                <div class="input-group oe_website_spinner" style="margin: auto;">
                                                    <span class="input-group-addon mb8" t-att-onclick="'minus(&quot;product_%s_value&quot;)' %p.id">
                                                        <i class="fa fa-minus"></i>
                                                    </span>
                                                    <input class="form-control" data-min="1" t-att-id="'product_%s_value' %p.id" name="add_qty" value="0" type="text"/>
                                                    <span class="input-group-addon mb8 float_left" t-att-onclick="'plus(&quot;product_%s_value&quot;)' %p.id">
                                                        <i class="fa fa-plus"></i>
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                        -->

                                    </div>
                                    <hr style="width: 100%"/>
                                    <div class="form-group">
                                        <div class="col-md-8">
                                            <label class="col-md-4 control-label" for="radios">
                                                <span class="pull-right">Beställningstyp:</span>
                                            </label>
                                            <div class="col-md-8 mb16">
                                                <label class="radio-inline" for="radios-0">
                                                    <input name="radios" id="radios-0" value="1" checked="checked" type="radio"/> typ 1
                                                </label>
                                                <label class="radio-inline" for="radios-1">
                                                    <input name="radios" id="radios-1" value="2" type="radio"/> typ 2
                                                </label>
                                                <label class="radio-inline" for="radios-2">
                                                    <input name="radios" id="radios-2" value="3" type="radio"/> typ 3
                                                </label>
                                                <label class="radio-inline" for="radios-3">
                                                    <input name="radios" id="radios-3" value="4" type="radio"/> typ 4
                                                </label>
                                            </div>
                                            <label class="col-md-4 control-label" for="leveransvecka">
                                                <span class="pull-right">Leveransvecka:</span>
                                            </label>
                                            <div class="col-md-8 mb16">
                                                <div class="">
                                                    <select id="leveransvecka" name="leveransvecka" class="form-control selectpicker dropup" data-style="btn-primary">
                                                        <option value="1">Vecka 1</option>
                                                        <option value="2">Vecka 2</option>
                                                        <option value="3">Vecka 3</option>
                                                        <option value="4">Vecka 4</option>
                                                    </select>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4">
                                        <button id="spara" name="spara" class="btn btn-success btn-lg pull-right">Spara</button>
                                    </div>
                                </div>

                                <!-- Kedjans sortiment -->
                                <div id="kedjans_sortiment" class="tab-pane fade in" style="padding: 0px;">
                                    <div class="container mb64">
                                        <h2 class="text-center mb32" t-esc="partner.parent_id.name"/>
                                        <t t-foreach="parent_products" t-as="pp">
                                            <t t-if="pp in partner.product_ids">
                                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 mt8 mb8" style="padding: 10px 0px; background: #ddd;">
                                                    <div class="col-xs-6 col-sm-7 col-md-7 col-lg-7">
                                                        <img itemprop="image" class="img img-responsive" style="margin: auto;" t-att-src="'/website/image/product.product/%s/image/150x150' %pp.id"/>
                                                    </div>
                                                    <div class="col-xs-6 col-sm-5 col-md-5 col-lg-4 col-lg-offset-1">
                                                        <p class="text-center">
                                                            <t t-if="pp.default_code">
                                                                <span>[<t t-esc="pp.default_code"/>] </span>
                                                            </t>
                                                            <span class="text-center" t-field="pp.product_tmpl_id"/>
                                                        </p>
                                                        <div class="text-center" style="margin: auto;">
                                                            <i style="font-size: 2em;" class="fa fa-check"></i>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t>
                                            <t t-if="pp not in partner.product_ids">
                                                <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 mt8 mb8" style="padding: 10px 0px; background: #AAFCA9;">
                                                    <div class="col-xs-6 col-sm-7 col-md-7 col-lg-7">
                                                        <img itemprop="image" class="img img-responsive" style="margin: auto;" t-att-src="'/website/image/product.product/%s/image/150x150' %pp.id"/>
                                                    </div>
                                                    <div class="col-xs-6 col-sm-5 col-md-5 col-lg-4 col-lg-offset-1">
                                                        <p class="text-center">
                                                            <t t-if="pp.default_code">
                                                                <span>[<t t-esc="pp.default_code"/>] </span>
                                                            </t>
                                                            <span class="text-center" t-field="pp.product_tmpl_id"/>
                                                        </p>
                                                        <div class="text-center" style="margin: auto;">
                                                            <a href="#"><i class="fa fa-plus" style="font-size: 2em;"></i></a>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t>
                                        </t>
                                    </div>
                                </div>

                                <!-- Kundkort -->
                                <div class="tab-pane fade in active col-xs-12 col-md-12 col-lg-12" id="kund_kort" style="padding: 0px;">
                                    <!-- TODO: design kundkort -->
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </t>
    </template>

    <template id="crm_javascript" inherit_id="website.layout">
        <xpath expr="//body" position="inside">
            <script>
                function minus(product_id)
                {
                    value = parseInt(document.getElementById(product_id).value)
                    if(value &gt; 0){
                        value --;
                        document.getElementById(product_id).value = value;
                    }
                }

                function plus(product_id)
                {
                    value = parseInt(document.getElementById(product_id).value) + 1;
                    document.getElementById(product_id).value = value;
                }

                $(".talbe_cell").hide();
                function toggle_cell(product_id)
                {
                    var product = "product_cell_" + product_id;
                    $("#" + product).slideToggle("slow");
                }

                /*
                var Users = new openerp.Model('res.users');
                Users.call('change_password', ['oldpassword', 'newpassword'],
                  {context: some_context}).then(function (result) {
                    // do something with change_password result
                });
                Users.query(['name', 'login', 'user_email', 'signature'])
                     .filter([['active', '=', true], ['company_id', '=', main_company]])
                     .limit(15)
                     .all().then(function (users) {
                    // do work with users records
                });
                */


                /*
                window.alert("Booooooooooom");
                var Partners = new openerp.Model('res.partner');
                window.alert(Partners.query);
                Partners.search([])
                 .filter([])
                 .first().then(function (users) {
                    console.log("Heeeeeeeeeeeeej " + users.name);
                 });
                 */

            </script>
        </xpath>
    </template>

    </data>
</openerp>
